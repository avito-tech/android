---
title: Запуск тестов
type: docs
---

# Запуск тестов

{{<avito page>}}

В данном документе собраны способы запуска unit и instrumentation тестов. Описаны наборы тестов, которые запускаются
автоматически, а также способы позволяющие запустить нужные тесты в ручном режиме.

## Автоматически запускаемые тесты

Существует несколько наборов тестов, запускаемых автоматически.

### Тесты на PR

При создании Pull Request'а ваша ветка ребейзится на целевую ветку и
[автоматически запускаются](http://links.k.avito.ru/PV):
- Юнит тесты
- Инструментальные тесты:
  - Перформанс
  - Компонентные
  - [Скриншотные]({{< ref "/docs/test/ScreenshotTesting.md" >}})
  - Интеграционные (`@IntegrationTest`)
- [Android Lint]({{< ref "/docs/checks/AndroidLint.md" >}})

За подробностями можно обратиться к конфигурации `fastCheck` в `avito/build.gradle`.

### Проверки develop'а

Раз в 3 часа при наличии изменений на develop-ветке [запускаются](http://links.k.avito.ru/5u) следующие проверки:
- Юнит тесты
- Инструментальные тесты:
  - Компонентные
  - E2E
  - [Скриншотные]({{< ref "/docs/test/ScreenshotTesting.md" >}})
  - Интеграционные (`@IntegrationTest`)
  - Ручные (`@ManualTest`)
- [Android Lint]({{< ref "/docs/checks/AndroidLint.md" >}})

**ВАЖНО!** Тесты, почеменные как [`@Flaky`]({{< ref "/docs/test/FlakyTests.md" >}}) запускаются, но на результат прогона
не влияют.

За подробностями можно обратиться к конфигурации `fullCheck` в `avito/build.gradle`.

### Регресс

Регресс [автоматически запускается](http://links.k.avito.ru/OjE) каждый день со вторника по субботу в 5 и 8 утра, а
также каждые 4 часа в понедельник и воскресенье. Результаты прогонов агрегируются в отчет по коммиту, с которого был
запущен регресс, и упавшие тесты рассылаются ответственным юнитам в соответствующие чаты в Slack.

Регресс включает в себя:
- Юнит тесты
- Инструментальные тесты:
  - Компонентные
  - E2E
  - [Скриншотные]({{< ref "/docs/test/ScreenshotTesting.md" >}})
  - Интеграционные (`@IntegrationTest`)
  - Ручные (`@ManualTest`)
- [Android Lint]({{< ref "/docs/checks/AndroidLint.md" >}})

За подробностями можно обратиться к конфигурации `release` в `avito/build.gradle`.

## Запуск тестов вручную

### IDE

Обрати внимание на [кастомные конфигурации]({{< ref "/docs/ide/Configurations.md" >}})

#### Robolectric

Просто запускаем стрелками Run напротив имени тестового класса или метода.

#### Instrumentation

Аналогично Robolectric тестам - просто запускаем тест средствами Android Studio.

### Запуск всех E2E тестов

Для запуска всех E2E тестов воспользуйтесь Team City конфигураций [fullCheck](http://links.k.avito.ru/5u). В настройках
запуска можно задать следующие параметры:
- Ветку для запуска (*Changes -> Build branch*)
- API URL, в который ходят тесты (*Parameters -> Test URL*)

### Запуск тестов в CI с кастомными параметрами {#custom-run}

В Teamcity есть [конфигурация `instrumentationDynamic`](http://links.k.avito.ru/tmctAvitoAndroidInstrumentationDynamic)
для запуска тестов со специфическим набором требований.

Запускайте и вам будет предложено выбрать:
- Ветку для запуска (*Changes -> Build branch*)
- API URL, в который ходят тесты (*Parameters -> Test URL*)
- Предустановленный набор тестов (*Parameters -> env.DYNAMIC_FILTER*)
  - `ui` -- компонентные, E2E, скриншотные, интеграционные тесты
  - `uiNoE2E` -- как `ui`, но без E2E тестов
  - `regressionNoE2E` -- `uiNoE2E` + ручные тесты
  - `regression` -- `ui` + ручные тесты
  - `performanceNoE2E` -- только компонентные перформанс тесты
  - `performance` -- только функциональные перформанс тесты
- Фильтр тестов в формате `[+ имя класса [+ имя тестового метода ]]` (*Parameters -> Package prefix*)
- Количество запусков. Полезно для [отладки нестабильных тестов]({{< ref "/docs/test/TroubleshootingUI.md" >}})
  (*Parameters -> Retry count*)
- Версии API (*Parameters -> * Api*)

### Локальный запуск тестов в инфре

Сейчас в разработке находится механизм локального запуска инструментальных тестов на эмуляторах в кубе. Уже работает для
тестового приложения в инфре. Подробности [здесь]({{< ref "/docs/test/Runner.md" >}}).

